{% extends 'base.html.twig' %}

{% block title %}Movie-DB{% endblock %}

{% block body %}
    <h1>Movies</h1>
    <div class="row">
        <div class="col-sm-6">
            <p><a class="btn btn-primary" data-toggle="tooltip" title="Create a new movie entry" href="/new">New Movie</a></p>
        </div>
        <div class="col-sm-6">
            

            
        </div>
    </div>
    <ul class="list-group">
        {% for movie in movies %}
            <li class="list-group-item">
                <div class="row">
                    <div class="col-sm-7">
                        <p>{{ movie.titleOrig }}</p>
                        <p class="small">{{ movie.titleDe }}</p>
                    </div>
                    <div class="col-sm-7">
                        {% for tag in movie.tags %}
                          <p>{{ tag }} ({{ tag.getRatingForMovie(movie) }})</p>
                        {% endfor %}
                    </div>
                    <div class="col-sm-3 text-right">
                        <a class="btn btn-info" data-toggle="tooltip" title="Go to IMDB title" href="http://www.imdb.com/title/{{ movie.imdbId }}">IMDB</a>
                        <a class="btn btn-warning" data-toggle="tooltip" title="Modify this movie" href="/modify/{{ movie.id }}">Modify</a>
                        <a class="btn btn-danger" data-toggle="tooltip" title="Delete this movie from the database" href="/delete/{{ movie.id }}">Delete</a>
                    </div>
                </div>
            </li>
        {% endfor %}
    </ul>

<script type="text/javascript">
$(".js-data-example-ajax").select2({
  ajax: {
    url: "https://api.github.com/search/repositories",
    dataType: 'json',
    delay: 250,
    data: function (params) {
      return {
        q: params.term, // search term
        page: params.page
      };
    },
    processResults: function (data, params) {
      // parse the results into the format expected by Select2
      // since we are using custom formatting functions we do not need to
      // alter the remote JSON data, except to indicate that infinite
      // scrolling can be used
      params.page = params.page || 1;
 
      return {
        results: data.items,
        pagination: {
          more: (params.page * 30) < data.total_count
        }
      };
    },
    cache: true
  },
  escapeMarkup: function (markup) { return markup; }, // let our custom formatter work
  minimumInputLength: 1,
  //templateResult: formatRepo, // omitted for brevity, see the source of this page
  //templateSelection: formatRepoSelection // omitted for brevity, see the source of this page
});
</script>

{% endblock %}